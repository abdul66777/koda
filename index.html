<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>KODA Mining Calculator (Realtime)</title>
  <style>
    body { font-family: Arial; max-width: 600px; margin: 40px auto; }
    input, button { padding: 8px; margin: 5px 0; width: 100%; }
    .result { background: #f4f4f4; padding: 15px; margin-top: 20px; }
  </style>
</head>
<body>

  <h2>KODA Mining Calculator (Realtime)</h2>

  <label>Hashrate Anda (MH/s):</label>
  <input type="number" id="hashrate" placeholder="Contoh: 100" step="0.01">

  <label>Biaya sewa per hari (USD):</label>
  <input type="number" id="rentalCost" placeholder="Contoh: 1.5" step="0.01">

  <button onclick="calculate()">Hitung</button>

  <div class="result" id="result" style="display: none;"></div>

 <script>
  async function calculate() {
    const hashrateUser = parseFloat(document.getElementById('hashrate').value);
    const rentalCost = parseFloat(document.getElementById('rentalCost').value);
    const resultDiv = document.getElementById('result');

    if (isNaN(hashrateUser) || isNaN(rentalCost) || hashrateUser <= 0) {
      alert("Mohon isi semua input dengan benar.");
      return;
    }

    try {
      const [priceRes, netHashRes, rewardRes] = await Promise.all([
        fetch('https://api.k0bradag.com/price'),
        fetch('https://api.k0bradag.com/info/hashrate'),
        fetch('https://api.k0bradag.com/info/blockreward')
      ]);

      const priceData = await priceRes.json();
      const netHashData = await netHashRes.json();
      const rewardData = await rewardRes.json();

      const priceUSD = parseFloat(priceData.price_usd);
      const netHashrateMH = parseFloat(netHashData.hashrate) * 1000; // GH/s â†’ MH/s
      const blockReward = parseFloat(rewardData.reward ?? rewardData.block_reward ?? 0);
      const blocksPerDay = 86400;

      if (isNaN(priceUSD) || isNaN(netHashrateMH) || isNaN(blockReward)) {
        resultDiv.innerHTML = "Gagal menghitung. Pastikan data API valid.";
        resultDiv.style.display = 'block';
        return;
      }

      const dailyKODA = (hashrateUser / netHashrateMH) * blockReward * blocksPerDay;
      const dailyUSD = dailyKODA * priceUSD;
      const profit = dailyUSD - rentalCost;

      resultDiv.innerHTML = `
        <strong>Estimasi Hasil Harian:</strong><br>
        Network Hashrate: ${netHashrateMH.toFixed(2)} MH/s<br>
        KODA/hari: <b>${dailyKODA.toFixed(2)}</b><br>
        USD/hari: <b>$${dailyUSD.toFixed(4)}</b><br>
        Profit: <b style="color:${profit >= 0 ? 'green' : 'red'};">$${profit.toFixed(4)}</b>
      `;
      resultDiv.style.display = 'block';

    } catch (err) {
      resultDiv.innerHTML = "Gagal mengambil data dari API.";
      resultDiv.style.display = 'block';
      console.error(err);
    }
  }
</script>


</body>
</html>
